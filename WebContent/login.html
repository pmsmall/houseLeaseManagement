<!DOCTYPE html>
<html>

	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
		<title>房屋租赁系统</title>
		<link rel="stylesheet" type="text/css" href="css/styles.css" />
		<link rel="stylesheet" href="css/normalize.min.css">
		<link rel="stylesheet" type="text/css" href="css/action.css" />

		<script type="text/javascript" src="js/jquery-3.3.1.min.js"></script>
		<script type="text/javascript" src="js/jquery.validate.min.js"></script>
		<script type="text/javascript" src="js/localization/messages_zh.js"></script>
		<script type="text/javascript" src="js/jquery.serializejson.min.js"></script>
		<script src="js/jquery.shCircleLoader.js" type="text/javascript"></script>

		<script type="text/javascript">
			function responseHandle(data) {
				if(data['status']) {
					var form = $('.form');
					if(form.hasClass('main_rotate'))
						form.removeClass('main_rotate');
					else
						$('.form').addClass('main_rotate');
					//$('.wait').css('display', 'none');
					setTimeout("window.location.href='/houseLeaseManagement/center';",
						2000);
				} else {
					alert("登录失败\n用户名不存在或者密码错误");
					$('.wait').css('display', 'none');
				}
			}

			function mySubmit() {
				var wait = $('#login-button+.wait');
				wait.css('display', 'block');
				wait
					.shCircleLoader({
						keyframes: "0%{background:white}40%{background:transparent}60%{background:transparent}100%{background:white}"
					});

				$
					.ajax({
						url: "http://localhost:8080/houseLeaseManagement/logincheck.action",
						type: "post",
						contentType: 'application/json;charset=UTF-8',
						data: JSON.stringify($('#loginform').serializeJSON()),
						dataType: "json",
						success: function(data) {
							responseHandle(data);
						},
						error: function() {
							alert("error");
						}
					});
			}
		</script>
	</head>

	<body>
		<div class="wrapper">
			<ul class="bg-bubbles">
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
				<li></li>
			</ul>
		</div>

		<div style="overflow: hidden; width: 100%; height: 100%; position: fixed;">
			<div class="form motionDiv">
				<h1>房屋租赁系统</h1>
				<ul class="tab-group">
					<li class="tab">
						<a href="#signup">注册</a>
					</li>
					<li class="tab active">
						<a href="#login">登录</a>
					</li>
				</ul>
				<div class="tab-content">
					<div id="login">
						<h1>欢迎回来!</h1>

						<form id="loginform" onsubmit="return false" action="##" method="post">

							<div class="field-wrap">
								<label>用户名 <span class="req">*</span>
							</label> <input type="text" name="username" required autocomplete="off" />
							</div>

							<div class="field-wrap">
								<label>密码 <span class="req">*</span>
							</label> <input type="password" name="password" required autocomplete="off" />
							</div>

							<p class="forgot">
								<a href="#">忘记密码?</a>
							</p>

							<button type="submit" id="login-button" class="button button-block">登录</button>
							<div id="wait" class="field-wrap wait"></div>
						</form>

					</div>
					<div id="signup">
						<h1>免费注册</h1>

						<form action="/" method="post">

							<div class="top-row">
								<div class="field-wrap">
									<label> First Name<span class="req">*</span>
								</label> <input type="text" required autocomplete="off" />
								</div>

								<div class="field-wrap">
									<label> Last Name<span class="req">*</span>
								</label> <input type="text" required autocomplete="off" />
								</div>
							</div>

							<div class="field-wrap">
								<label> Email Address<span class="req">*</span>
							</label> <input type="text" required autocomplete="off" />
							</div>

							<div class="field-wrap">
								<label> Set A Password<span class="req">*</span>
							</label> <input type="password" required autocomplete="off" />
							</div>
							<button type="submit" class="button button-block">现在开始</button>
							<div id="wait" class="field-wrap wait"></div>
						</form>

					</div>

				</div>
				<!-- tab-content -->

			</div>
		</div>
		<script src="js/index.js"></script>

		<script type="text/javascript">
			$().ready(function() {
				validateForm();
			});

			function validateForm() {
				$("#loginform").validate({
					rules: {
						username: {
							required: true,
						},

						password: {
							required: true,
						},

					},
					messages: {
						username: {
							required: "请输入用户名",
						},

						password: {
							required: "请输入密码",
						},

					},
					submitHandler: function(form) {
						mySubmit();
					}
				});
			}
			var error = "${error}";
			if(error == "error") {
				alert("帐户名或密码错误");
			}
		</script>
		<iframe src="background.html" seamless width="100%" height="100%" style="position: fixed; z-index: -1; overflow: hidden;"></iframe>
	</body>

</html>